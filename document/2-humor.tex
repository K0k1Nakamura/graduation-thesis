\chapter{ユーモアの生成について}
この章では,システムが発話するユーモアの種類とその内容,生成手法について具体的に述べる。





\section{知識の獲得}
この節では,ユーモアの生成の際に必要となる知識の獲得についてまず述べる。


\subsection{概念辞書の作成}\label{sec:dict}
ユーモアの生成には,豊富な知識と正確な情報が必要である\cite{Ganso}。そのため,提案システムでは,吉田らが作成した概念辞書\cite{humor_yoshida}を用いる。
この概念辞書は主に以下の2つの概念辞書を組み合わせたものである。
\begin{itemize}
\item 日本語Wordnet\cite{Wordnetweb}\\
\hspace{1zw}日本語Wordnetとは独立行政法人情報通信機構（NICT）により作成された概念辞書のことである。語を類義関係のセット (synset)でグループ化している点に特徴があり,一つのsynsetが一つの概念に対応する。また,各synsetは上位下位関係などの多様な関係で結ばれている。

\item 日本語語彙体系\cite{Goitaikei}\\
\hspace{1zw}日本語語彙体系とはNTTコミュニケーション科学基礎研究所が開発した,語彙を体系別に分類した大規模日本語辞書である。
\end{itemize}
\hspace{1zw}この二つの概念辞書は固有名詞を多く扱っていないという欠点がある。そこで山田ら\cite{Yamada}の手法を用いて,Wikipedia\cite{Wikipedia}に登録されている固有名詞を追加した。
これによって,入力文に固有名詞があっても対応可能となり,また応答文として多様な固有名詞を扱うことも可能となっている。



\subsection{概念と用言の結合}\label{sec:verb}
入力文が『みかんを食べる』だった場合の概念辞書から抽出される情報を,図\ref{fig:gainenn}に示す。


\begin{figure}[tb]
 \begin{center}
  \includegraphics[scale=0.50]{./fig/gainenn.eps}
  \caption{入力文が『みかんを食べる』の時，概念辞書から抽出される情報の例}
  \label{fig:gainenn}
 \end{center}
\end{figure}




\ref{sec:dict}で生成された概念辞書には,『みかんを食べる』のような名詞と用言の繋がりまでは登録されておらず,応答文として妥当なものを作るのが困難であった。\\
\hspace{1zw}そこで京都大学格フレーム\cite{Kakuframe}を用いて,単語と概念を包括的に扱う。これは,名詞の概念と用言を表層格と呼ばれる格フレームで繋げたものである。
この時，このリンクを京都大学各フレームで用いられているWeb16億文の出現頻度により,重みづけを施す。\\
\hspace{1zw}このようにして得られた概念辞書を用いて,入力文の名詞の概念と用言の結合の解析を行う。\\
\hspace{1zw}例えば,『みかんを食べる』という入力の場合,みかんの概念『food』が用言『食べる』に表層格『ヲ格』で繋がっているといった情報を得る。



\subsection{単語の親密性}\label{sec:topic}
概念辞書に登録されている単語の中には,我々の生活の中で、あまり使用頻度が少なく耳慣れない単語も含まれている。
そのため,予め概念辞書に登録されている単語に親密性のスコアを付与する。
このスコアには,Twitter\cite{Twitter}でつぶやかれた単語の頻度を基に算出する。
ユーモアで用いる単語として,この親密性が高い程,発話候補の単語のなかで選択確率が比例して高くなる。\\
\hspace{1zw}また,ユーザの発話中において抽出された名詞の中で,親密性が低いものをその発話における話題とする。
以下,このようにして選ばれた名詞,つまりTwitterでの使用頻度が少ない名詞を話題語とする。\\
\hspace{1zw}例として,応答候補の単語の中に『みかん』(スコア100)と『ドドリア』(スコア2)があるとする。
この場合,システムが発話に用いる際，応答候補の単語として，『ドドリア』より親密性スコアが高い『みかん』が選択されやすくなる。
また，入力文の中に『みかん』と『ドドリア』があった場合,親密性スコアが低い方，つまり『ドドリア』が話題語となる。






\section{ユーモアの種類の定義}
この節では,ユーモアの種類として,攻撃ユーモア,支援ユーモア,遊戯ユーモアの3つに関して説明を行う。
これらのユーモアは\cite{UENO,Tani,牧野}らを始め，広く用いられている３種類を用いた。\\
\hspace{1zw}攻撃ユーモアは,本来ならば風刺やブラックジョークのことを指すが,普段の雑談においてこれらを言う機会はあまりない。
そこで,今回の提案システムでは,攻撃ユーモアをユーザの発話から得られた名詞（話題語）から派生するネガティブな名詞を言うことを攻撃ユーモアと定義する。\\
\hspace{1zw}支援ユーモアは,ユーモアを通してユーザの悩みを和らげる\cite{UENO}事をいう,今回は入力文の意味解析は行っていない。
そのため,ユーザが悩んでいるかどうかまでは推定できない。
そこで,ユーザの発話から得られた名詞から派生するポジティブな単語を言ったり,攻撃ユーモアの対象をユーザではなくシステムに向けて自虐的発話をすることを支援ユーモアとする。\\
\hspace{1zw}遊戯ユーモアは,ユーザの発話から得られる名詞をもじったダジャレや形容詞からの喩えを遊戯ユーモアとして定義する。
以下の節からは,上記の3つユーモアの生成手法について,攻撃ユーモア,支援ユーモア,遊戯ユーモアの順で説明していく。







\section{攻撃ユーモアの生成}\label{sec:attack}
この節では攻撃ユーモアの生成について説明する。攻撃ユーモアは『ユーモアでユーザの気分を害すこと』を目的とする。
今回,攻撃ユーモアとしては,以下の2つを用意した。
\begin{itemize}
\item ネガティブな名詞を用いたツッコミ
\item ネガティブな形容詞を用いた応答
\end{itemize}



\subsection{ネガティブな名詞,用言を用いたツッコミ}\label{sec:ata1}
入力文の話題語を用いる。
まず,構文解析器KNP\cite{KNP}を用いて,話題語のドメインとカテゴリを得る。ここでドメインの種類と例を表\ref{tb:domain},カテゴリの種類と例を
表\ref{tb:category}に記す。



\begin{table}[tb]
\begin{center}
\caption{ドメイン一覧}
\label{tb:domain}
\begin{tabular}{| c | c || c | c | }
\hline
    \textgt{ドメイン名} & \textgt{例} & \textgt{ドメイン名} & \textgt{例} \\ \hline\hline
    文化・芸術 & 映画, 音楽, 御輿 & 交通 &駅, 道路, アクセル \\\hline
    レクリエーション & 観光, 花火, カジノ & 教育・学習 & 先生, 算数, 開校 \\\hline
    スポーツ & 選手, 野球, 角界 & 科学・技術 & 研究, 理論, ウラン \\\hline
    健康・医学 & 手術, 診断, 胃液 & ビジネス & 輸入, 市場, 売上 \\\hline
	家庭・暮らし & 育児, 家事, 帰省 &メディア & 放送, 記者, 載る \\\hline
	料理・食事 & 箸, 昼食, 和える & 政治 &司法, 税, 挙党 \\\hline
	ドメイン無し & 青, 感情, 上がる &  & \\\hline
\end{tabular}
\end{center}
\end{table}


\begin{table}[tb]
\begin{center}
\caption{カテゴリ一覧}
\label{tb:category}
\begin{tabular}{| c | c || c | c | }
\hline
    \textgt{カテゴリ名} & \textgt{例} & \textgt{カテゴリ名} & \textgt{例} \\ \hline\hline
    人 & 学生, 先生 & 場所-施設 &ビル, 公園 \\\hline
    組織・団体 & 政府, 企業 & 場所-施設部位 & 天井, 床 \\\hline
    動物 & 犬, 猫 & 場所-自然 & 山, 海 \\\hline
    植物 & 桜, バラ & 場所-機能 & 上, 下 \\\hline
	動物-部位 & 手, 足 & 場所-その他 & 都市, 村 \\\hline
	植物-部位 & 葉, 枝 & 抽象物 & 思考, 理由 \\\hline
	人工物-食べ物 & パン, コーヒー & 形・模様& 円, 球 \\\hline
	人工物-衣類 & ズボン, セーター & 色 & 赤, 青 \\\hline
	人工物-乗り物 & 自動車. 飛行機 & 数量 & 複数, メートル \\\hline
	人工物-金銭 & 給料, 借金 & 時間 & 今日, 朝 \\\hline
	人工物-その他 & 鉛筆, 消しゴム & 自然物 & 石, 岩 \\\hline
\end{tabular}
\end{center}
\end{table}



例えば,『今日,みかんを食べた』と入力すると,話題語として『みかん』が抽出され,話題語のドメインとして『料理・食事』,カテゴリとして『人工物-食べ物』が得られる。
以下,例文で『みかんを食べた』という時は,このドメイン,カテゴリを用いる。
得られた話題語のドメイン，もしくはカテゴリが一致する名詞を3章で説明する日本語評価極性辞書のネガティブ名詞群の中からランダムで返す。\\
\hspace{1zw}例として『みかん』なら『苦汁』といった名詞が得られ,応答として『お前は苦汁でも食べとけ』といった応答が返される。




\subsection{ネガティブな形容詞を用いた応答}\label{sec:ata2}
ネガティブな形容詞を用いてユーモアを生成する。このユーモアの作成には
\ref{sec:verb}で得た話題語の概念に結合する形容詞群のうちネガティブな形容詞を選択することで攻撃ユーモアを生成する。\\
\hspace{1zw}例として,『コーヒーを飲んだよ』という入力があったとする。
まず,話題語としてコーヒーが選ばれる。
そして話題語に格フレーム『ハ格』で繋がる形容詞として『美味しい』や『不味い』などが得られる。
得られた形容詞の中で,Negative極性の『まずい』を選択し,『コーヒーはまずいよね』といったものが返される。\\
\hspace{1zw}このような応答を攻撃ユーモアと吉田ら\cite{humor_yoshida}が定義したように,我々もこれを攻撃ユーモアとする。







\section{支援ユーモアの生成}\label{sec:maso}
この節では支援ユーモアの生成について説明する。支援ユーモアは，『ユーモアでユーザを励ますこと』を目的とする。
今回は,支援ユーモアとして以下のものを用意した。

\begin{itemize}
\item ポジティブな名詞を用いた感想
\item ポジティブな形容詞を用いた励まし
\item システムを自虐する応答
\end{itemize}

ここで，システムを自虐する応答について説明する。
ユーモアは\cite{UENO,Tani,牧野}らのように,ユーモアとして攻撃,支援，遊戯ユーモアの３種類を提唱する研究者もいる。
一方\cite{塚脇}らのようにユーモアを攻撃,自虐,遊戯ユーモアの３種類を提唱する研究者もいる。
つまり,支援ユーモアを用いるか,自虐ユーモアを用いるかの２つの意見がある。
そこで,我々は支援ユーモアと自虐ユーモアを統合させ，支援ユーモアとした。

\subsection{ポジティブな名詞を用いた感想}
\ref{sec:ata1}で示した
攻撃ユーモアの『ネガティブな単語を用いた応答』で得るネガティブな単語を,ポジティブにすることでユーザを直接的に支援するユーモアである。\\
\hspace{1zw}例として,『みかんを食べた』と入力すると,『モチモチ感を食べたらなおよかった』といった応答文が返される。



\subsection{ポジティブな形容詞を用いた応答}
\ref{sec:ata2}で示した
攻撃ユーモアの『ネガティブな形容詞を用いた応答』で得るネガティブな形容詞をポジティブにすることでユーザを直接的に支援するユーモアである。\\
\hspace{1zw}例として,『みかんを食べた』と入力すると,『あなたは美味しいみかんのようです』といった応答文が返される。



\subsection{システムを自虐する応答}
この節は,システム自身を自虐する支援ユーモアについて説明する。
このユーモアは２種類用意した。以下にその内容を示す。
\begin{itemize}
\item ネガティブな名詞の対象をシステムに向ける\\
\hspace{1zw}\ref{sec:ata1}で得られたネガティブな単語をシステムに向けることで自虐ユーモアを生成する。\\
\hspace{1zw}例として，『みかんを食べた』と入力すると,『逆に私は苦汁を食べますね』といった応答文が返される。

\item ネガティブな形容詞を用いた応答\\
\hspace{1zw}\ref{sec:ata2}で得られたネガティブな形容詞をシステムに向けることで自虐ユーモアを生成する。\\
\hspace{1zw}例として，『みかんを食べた』と入力すると,『私の心はまずいみかんのようです』といった応答文が返される。
\end{itemize}



\subsection{遊戯ユーモアの生成}\label{sec:game}
この節では,遊戯ユーモアの生成について説明する。遊戯ユーモアは『ユーモアでユーザを楽しませること』を目的とする。
遊戯ユーモアの種類は以下の2つである。
\begin{itemize}
\item ダジャレ
\item 喩え
\end{itemize}



\subsection{ダジャレ}\label{sec:punpun}
入力された話題語を音韻が似ている別の単語に置き換えてユーモアを生成する。
今回は入力された話題語と置き換える別の単語の文字数は統一した。
それは,生成されるユーモアがダジャレであるというのを,ユーザに明確に示すためである。
ここで音韻類似度の計算にはDPマッチング手法\cite{dpmatching}\cite{dpcite}を用い,2単語間の音韻類似度のスコア算出では山根らの手法
\cite{Yamane}を用いている。\\
\hspace{1zw}例として『みかんを食べたよ』と入れると,『え？チタンを食べたよ？私の聞き間違いですか？？』と言った応答文が返される。



\subsection{喩え}
この手法は入力文の単語から何かに喩える手法である\cite{Nakamura}。
今回は入力された形容詞から何かに喩える手法を用いた。
具体的には,\ref{sec:verb}で用いた概念-用言間結合を用いて，入力された形容詞とリンクをもつ,名詞を得る。\\
\hspace{1zw}例として,『今日は朝が早かった』と入力すると,図\ref{fig:tatoe}のように,形容詞として『早い』が抽出,その概念と共通の概念を持つ名詞を抽出する。
そして,『早いってまるで石器時代だね』といった応答がなされる。

\begin{figure}[tb]
 \begin{center}
  \includegraphics[scale=0.70]{./fig/tatoe.eps}
  \caption{喩えの生成図}
  \label{fig:tatoe}
 \end{center}
\end{figure}


\section{ユーモアのテンプレート応答}\label{sec:humor_template}
\ref{sec:attack}や\ref{sec:maso},\ref{sec:punpun}のユーモアの生成の際には，入力文に話題語が必要であることが分かる。
また，\ref{sec:game}には，話題語と形容詞が必要であることが分かる。\\
\hspace{1zw}しかし，ユーザの入力文の中には,話題語を始め，ユーモア生成に必要な情報が含まれないことは往々にしてよく見受けられる。
今回，ユーモア生成に失敗した場合でも,『ユーモアを含まない応答』を返すのではなく，『ユーモアを含む応答』を返すことにした。
それは,ユーザの発話極性とユーモアの種類の関係性を崩したくなかったからである。
そのために,このような場合でもシステムが応答できるように,ユーモアの種類の目的に応じた応答文を予め用意した。\\
\hspace{1zw}以下,表\ref{tb:atatemp}は攻撃ユーモアのテンプレート,表\ref{tb:masotemp}は支援ユーモアのテンプレート,表\ref{tb:gametemp}は遊戯ユーモアのテンプレートを示す。

\begin{table}
\begin{center}
\caption{攻撃ユーモアのテンプレート}
\label{tb:atatemp}
\begin{tabular}{|c|}
\hline
攻撃ユーモアのテンプレート \\
\hline\hline
うるさいですね \\
\hline
怒るよ？ \\
\hline
あなたを悲しませたい \\
\hline
\end{tabular}
\end{center}
\end{table}


\begin{table}
\begin{center}
\caption{支援ユーモアのテンプレート}
\label{tb:masotemp}
\begin{tabular}{|c|}
\hline
支援ユーモア \\
\hline\hline
君を励ましたかった \\
\hline
もう私壊れます \\
\hline
君を救いたい \\
\hline
\end{tabular}
\end{center}
\end{table}


\begin{table}
\begin{center}
\caption{遊戯ユーモアのテンプレート}
\label{tb:gametemp}
\begin{tabular}{|c|}
\hline
遊戯ユーモア \\
\hline\hline
布団が吹っ飛んだ，なんてね \\
\hline
あなたを楽しませたい \\
\hline
\end{tabular}
\end{center}
\end{table}




\section{予備実験}\label{sec:pre}
この節では,ユーモアのタイミングや内容を考慮する際の予備実験の内容とその結果について説明する。
ユーモアのタイミングと内容を考慮する際に利用したものは\ref{sec:analysis}で得る,入力文の極性,ユーザの態度,連続性である。
今回は,この3つの指標を利用し,男性12人,女性6人の被験者に,予めユーモアのタイミングと内容の妥当性について調査をした。
表\ref{tb:PN}は入力文の極性とユーモアの関係,表\ref{tb:taido}はユーザの態度とユーモアの関係,表\ref{tb:renzoku}はユーモアの連続性についての結果を示す。
表\ref{tb:weight}は3つの重みづけの結果を示す。




\begin{table}
\begin{center}
\caption{正規化された極性}
\label{tb:PN}
\begin{tabular}{|c|c|c|p{6em}|p{6em}|p{6em}|}
\hline
\multicolumn{1}{|c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c|}{} & \multicolumn{3}{c|}{全体的にどの極性が多いか} \\
\cline{4-6}
\multicolumn{1}{|c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|} P &  \multicolumn{1}{c|}N &  \multicolumn{1}{c|}E \\
\hline
 &  & 攻撃ユーモア & \hspace{2zw}0.27 & \hspace{2zw}0.15 & \hspace{2zw}0.22 \\\cline{3-6}
 & P & 支援ユーモア & \hspace{2zw}0.25 & \hspace{2zw}0.35 & \hspace{2zw}0.28 \\\cline{3-6}
 &  & 遊戯ユーモア & \hspace{2zw}0.31 & \hspace{2zw}0.23 & \hspace{2zw}0.28 \\\cline{3-6}
 &  & ユーモア無し & \hspace{2zw}0.17 & \hspace{2zw}0.27 & \hspace{2zw}0.21 \\\cline{2-6}
 &  & 攻撃ユーモア & \hspace{2zw}0.20 & \hspace{2zw}0.17 & \hspace{2zw}0.15 \\\cline{3-6}
1つ前の & N & 支援ユーモア & \hspace{2zw}0.34 & \hspace{2zw}0.37 & \hspace{2zw}0.36 \\\cline{3-6}
ユーザの &  & 遊戯ユーモア & \hspace{2zw}0.26 & \hspace{2zw}0.23 & \hspace{2zw}0.26 \\\cline{3-6}
発話極性 &  & ユーモア無し & \hspace{2zw}0.20 & \hspace{2zw}0.23 & \hspace{2zw}0.23 \\\cline{2-6}
 &  & 攻撃ユーモア & \hspace{2zw}0.21 & \hspace{2zw}0.18 & \hspace{2zw}0.25 \\\cline{3-6}
 & E & 支援ユーモア & \hspace{2zw}0.27 & \hspace{2zw}0.32 & \hspace{2zw}0.24 \\\cline{3-6}
 &  & 遊戯ユーモア & \hspace{2zw}0.30 & \hspace{2zw}0.25 & \hspace{2zw}0.25 \\\cline{3-6}
 &  & ユーモア無し & \hspace{2zw}0.22 & \hspace{2zw}0.25 & \hspace{2zw}0.27 \\\hline
\end{tabular}
\end{center}
\end{table}




\begin{table}
\begin{center}
\caption{正規化された文体}
\label{tb:taido}
\begin{tabular}{|c|c|c|p{6em}|p{6em}|}
\hline
\multicolumn{1}{|c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c|}{} & \multicolumn{2}{c|}{全体的に態度が良いか否か} \\\cline{4-5}
\multicolumn{1}{|c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c|}{} & \hspace{2zw}多い & \hspace{1.5zw}少ない \\\hline
 &  & 攻撃ユーモア & \hspace{2zw}0.12 & \hspace{2zw}0.21 \\\cline{3-5}
 & 良い & 支援ユーモア & \hspace{2zw}0.32 & \hspace{2zw}0.26 \\\cline{3-5}
 &  & 遊戯ユーモア & \hspace{2zw}0.25 & \hspace{2zw}0.26 \\\cline{3-5}
 今のユーザの &  & ユーモア無し &\hspace{2zw}0.31 & \hspace{2zw}0.28 \\\cline{2-5}
態度が &  & 攻撃ユーモア & \hspace{2zw}0.22 & \hspace{2zw}0.31 \\\cline{3-5}
良いか否か & 悪い & 支援ユーモア & \hspace{2zw}0.30 & \hspace{2zw}0.23 \\\cline{3-5}
 &  & 遊戯ユーモア & \hspace{2zw}0.23 & \hspace{2zw}0.24 \\\cline{3-5}
 &  & 無し & \hspace{2zw}0.25 & \hspace{2zw}0.23 \\\hline
\end{tabular}
\end{center}
\end{table}




\begin{table}[tb]
\begin{center}
\caption{正規化されたユーモアの連続性}
\label{tb:renzoku}
\begin{tabular}{| c | c |}
\hline
     \multicolumn{2}{| c |}{ユーモアの連続性} \\\hline
     攻撃ユーモアの連続性 & 0.18 \\\hline
     支援ユーモアの連続性 & 0.41 \\\hline
	 遊戯ユーモアの連続性 & 0.41 \\\hline
     
\end{tabular}
\end{center}
\end{table}




\begin{table}[tb]
\begin{center}
\caption{正規化された重みづけ}
\label{tb:weight}
\begin{tabular}{| c | c |}
\hline
     \multicolumn{2}{| c |}{重みづけ} \\\hline
	 ユーザの態度 & 0.43 \\\hline
     入力文の極性 & 0.57 \\\hline
     
\end{tabular}
\end{center}
\end{table}


これらの表の値を用いて,ユーモアを用いるか否か，また用いる際のユーモアの種類を決定する。その方法については\ref{sec:timing}で具体的に説明する。
